"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[632],{5632:(w,g,i)=>{i.r(g),i.d(g,{UsersModule:()=>B});var d=i(6895),h=i(529),m=i(4006),v=i(8277),c=i(3238),U=i(1961),A=i(6738),Z=i(2712),T=i(3677),S=i(8173),x=i(1689),C=i(508),p=i(1048),u=i(5990),e=i(4650),f=i(2210),L=i(9812),b=i(7341),_=i(6129),z=i(3162),I=i(8446),F=i(6172),M=i(4724);function J(a,r){1&a&&(e.TgZ(0,"div",20)(1,"b"),e._uU(2,"Unauthorize Access."),e.qZA()())}function Y(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",36),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(2);return e.KtG(o.updateUserStatus(n._id,!1))}),e._uU(2,"UNACTIVE"),e.qZA(),e.BQk()}}function y(a,r){if(1&a){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",36),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(2);return e.KtG(o.updateUserStatus(n._id,!0))}),e._uU(2,"ACTIVE"),e.qZA(),e.BQk()}}function N(a,r){if(1&a&&(e.TgZ(0,"tr",28)(1,"td",24)(2,"h2",29)(3,"a",30),e._UZ(4,"img",31),e.qZA(),e.TgZ(5,"a"),e._uU(6),e.qZA()()(),e.TgZ(7,"td",26)(8,"span",32)(9,"b"),e._uU(10),e.ALo(11,"number"),e.qZA()()(),e.TgZ(12,"td",25)(13,"div",33)(14,"button",34),e._uU(15),e.qZA(),e.TgZ(16,"div",35),e.YNc(17,Y,3,0,"ng-container",19),e.YNc(18,y,3,0,"ng-container",19),e.qZA()()(),e.TgZ(19,"td",25)(20,"h2",29),e._uU(21),e.qZA()(),e.TgZ(22,"td",25)(23,"h2",29),e._uU(24),e.qZA()(),e.TgZ(25,"td",26),e._uU(26),e.ALo(27,"date"),e.qZA()()),2&a){const t=r.$implicit;e.Q6J("ngClass",r.index%2==0?"even":"odd"),e.xp6(4),e.Q6J("src",null!=t&&null!=t.avatar&&t.avatar.length?null==t?null:t.avatar:"assets/img/patients/patient.jpg",e.LSH)("alt",t.name),e.xp6(2),e.hij("",t.name||"N/A"," "),e.xp6(4),e.Oqu(e.lcZ(11,11,t.orderCount)),e.xp6(5),e.hij(" ",t.isActive?"Active":"Unactive"," "),e.xp6(2),e.Q6J("ngIf",t.isActive),e.xp6(1),e.Q6J("ngIf",!t.isActive),e.xp6(3),e.hij(" ",t.mobileNumber||"N/A"," "),e.xp6(3),e.hij(" ",t.email||"N/A"," "),e.xp6(2),e.hij(" ",e.xi3(27,13,t.date,"d MMM, y")," ")}}function D(a,r){if(1&a&&(e.TgZ(0,"div",3)(1,"div",7)(2,"div",21)(3,"table",22)(4,"thead")(5,"tr",23)(6,"th",24),e._uU(7,"Name"),e.qZA(),e.TgZ(8,"th",25),e._uU(9,"Order Count"),e.qZA(),e.TgZ(10,"th",25),e._uU(11,"Status"),e.qZA(),e.TgZ(12,"th",26),e._uU(13," Mobile Number "),e.qZA(),e.TgZ(14,"th",26),e._uU(15,"Email"),e.qZA(),e.TgZ(16,"th",26),e._uU(17," Created At "),e.qZA()()(),e.TgZ(18,"tbody"),e.YNc(19,N,28,16,"tr",27),e.qZA()()()()()),2&a){const t=e.oxw();e.xp6(19),e.Q6J("ngForOf",t.pageData.docs)}}function P(a,r){1&a&&e._UZ(0,"mat-progress-bar",37)}function Q(a,r){if(1&a&&(e.ynx(0),e._UZ(1,"app-pagination",38),e.BQk()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("route","/users")("pageData",t.pageData)("pageSize",t.pageSize)("currentPage",t.page)}}const O=[{path:"",component:(()=>{class a{constructor(t,s,n,o,l,E){this.userService=t,this.uiService=s,this.route=n,this.router=o,this.fb=l,this.authService=E,this.dataIsLoaded=!1,this.page=1,this.pageSize=10,this.pageData={count:0,docs:[]},this.showFilter=!1,this.isFilterApplied=!1,this.authData=null,this.adminModules=u.W5}ngOnInit(){this.authData=this.authService.getAuthData,this.route.queryParams.subscribe(t=>{this.dataIsLoaded=!1,this.page=+t.page?+t.page:this.page,this.pageSize=+t.pageSize?+t.pageSize:this.pageSize,this.initForm(),this.fetchUsers()})}haveAccess(t,s){return(s?.adminRole?.permissions||[])?.findIndex(n=>n.module==u.W5.PAYOUT&&n[t])>=0||s?.role==u.xZ.SUPER_ADMIN}initForm(){let t=localStorage.getItem("userFilter"),s={status:[!0],createdAt:[null]};if(t){this.isFilterApplied=!0;let n=JSON.parse(t);s.status=[n.status],s.createdAt=[n.createdAt]}this.filterForm=this.fb.group(s)}applyFilter(t){this.isFilterApplied=!0,this.page=1,localStorage.setItem("userFilter",JSON.stringify(t)),this.fetchUsers()}clearFilter(){this.filterForm.reset({status:!0}),this.isFilterApplied=!1,localStorage.removeItem("userFilter"),this.fetchUsers()}onChangePageSize(t){this.dataIsLoaded=!1,this.pageSize=+t.target.value,this.fetchUsers()}fetchUsers(){!this.haveAccess("read",this.authData)||(this.dataIsLoaded=!1,this.pageData.count=0,this.pageData.docs=[],this.userService.fetchUsers(this.textSearch,this.page,this.pageSize,this.isFilterApplied,this.filterForm?.value).subscribe(t=>{this.pageData=t.data,this.dataIsLoaded=!0},t=>{this.dataIsLoaded=!1}))}resetPagination(){this.router.navigate(["/admins"],{queryParams:{page:1,pageSize:this.pageSize}})}onSearch(t){this.textSearch=t;let s=this.page;this.page=1,this.fetchUsers(),1!=s&&this.resetPagination()}updateUserStatus(t,s){this.uiService.openModal("#delete_modal",{modalTitle:"Update"}).afterClose.subscribe(n=>{n&&this.userService.updateStatus(t,s).subscribe(o=>{this.pageData.docs=this.pageData.docs.map(l=>(l._id==t&&(l.isActive=s),l)),this.uiService.openSnackbar(o.message)})})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(f.f),e.Y36(L.F),e.Y36(p.gz),e.Y36(p.F0),e.Y36(m.qu),e.Y36(b.e))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-list-user"]],decls:23,vars:6,consts:[[1,"page-wrapper"],[1,"content","container-fluid"],[1,"page-header"],[1,"row"],[1,"col-sm-7","col-auto"],[1,"page-title"],[1,"col-sm-5","col"],[1,"col-sm-12"],[1,"card"],[1,"card-body"],["id","DataTables_Table_0_wrapper",1,"dataTables_wrapper","dt-bootstrap4","no-footer"],[1,"row","w-100"],[1,"app-pagesize-dropdown","col",3,"pageSize","selectedPageSize"],[1,"col"],[1,"d-flex","align-content-center","float-right"],[1,"float-lg-right",3,"placeholder","inputText"],["class","text-center text-danger",4,"ngIf"],["class","row",4,"ngIf"],["mode","indeterminate",4,"ngIf"],[4,"ngIf"],[1,"text-center","text-danger"],[1,"table-responsive"],["id","DataTables_Table_0","role","grid","aria-describedby","DataTables_Table_0_info",1,"datatable","table","table-hover","table-center","mb-0","dataTable","no-footer"],["role","row"],[1,"sorting_1"],[1,"sorting_1","text-center"],[1,"text-center"],["role","row",3,"ngClass",4,"ngFor","ngForOf"],["role","row",3,"ngClass"],[1,"table-avatar"],[1,"avatar","avatar-sm","mr-2"],[1,"avatar-img","rounded-circle",3,"src","alt"],[1,"badge","badge-primary","badge-pill","p-2"],[1,"btn-group"],["type","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-info","dropdown-toggle","btn-sm"],[1,"dropdown-menu"],[1,"dropdown-item","cursor",3,"click"],["mode","indeterminate"],[1,"row","p-2",3,"route","pageData","pageSize","currentPage"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),e._uU(6,"Users"),e.qZA()(),e._UZ(7,"div",6),e.qZA()(),e.TgZ(8,"div",3)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12),e.NdJ("selectedPageSize",function(o){return s.onChangePageSize(o)}),e.qZA(),e.TgZ(15,"div",13)(16,"div",14)(17,"app-search-input",15),e.NdJ("inputText",function(o){return s.onSearch(o)}),e.qZA()()()(),e.YNc(18,J,3,0,"div",16),e.YNc(19,D,20,1,"div",17),e.YNc(20,P,1,0,"mat-progress-bar",18),e.qZA(),e.YNc(21,Q,2,4,"ng-container",19),e.qZA()()()()()(),e._UZ(22,"app-delete-modal")),2&t&&(e.xp6(14),e.Q6J("pageSize",s.pageSize),e.xp6(3),e.Q6J("placeholder","Search Name,Mobile Number,Email"),e.xp6(1),e.Q6J("ngIf",!s.haveAccess("read",s.authData)),e.xp6(1),e.Q6J("ngIf",s.dataIsLoaded&&s.haveAccess("read",s.authData)),e.xp6(1),e.Q6J("ngIf",!s.dataIsLoaded&&s.haveAccess("read",s.authData)),e.xp6(1),e.Q6J("ngIf",s.dataIsLoaded))},dependencies:[d.mk,d.sg,d.O5,_.z,z.pW,I.Q,F.C,M.J,d.JJ,d.uU],styles:[".avatar[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{object-fit:cover}"]}),a})()}];let j=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.Bz.forChild(O),p.Bz]}),a})(),B=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({providers:[f.f,{provide:h.TP,useClass:U.s,multi:!0},{provide:c._A,useClass:v.t7,deps:[c.Ad,v.o8]},{provide:c.sG,useValue:{parse:{dateInput:"LL"},display:{dateInput:"LL",dateA11yLabel:"LL",monthYearLabel:"MMM YYYY",monthYearA11yLabel:"MMMM YYYY"}}}],imports:[d.ez,j,h.JF,m.UX,C.m,Z.q,S.u,T.I,x.n,A.a]}),a})()}}]);