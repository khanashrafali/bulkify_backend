"use strict";(self.webpackChunkadmin_panel=self.webpackChunkadmin_panel||[]).push([[308],{1308:(Wt,J,l)=>{l.r(J),l.d(J,{ProductsModule:()=>Xt});var u=l(6895),I=l(529),d=l(4006),x=l(7803),D=l(8277),A=l(3238),y=l(641),b=l(8796),U=l(3877),O=l(508),f=l(8036),g=l(1048),S=l(5861),N=l(4128),Z=l(4004),T=l(5990),h=l(3887),F=l(6093),_=l(5120),t=l(4650),v=l(9812),M=l(6871),k=l(1637),Q=l(605),L=l(4654);function w(i,n){if(1&i&&(t.TgZ(0,"ng-option",54),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function V(i,n){if(1&i&&(t.TgZ(0,"ng-option",54),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function G(i,n){if(1&i&&(t.TgZ(0,"ng-option",54),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",null==e?null:e.brandName," ")}}function R(i,n){if(1&i&&(t.TgZ(0,"ng-option",54),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function K(i,n){if(1&i&&(t.TgZ(0,"div",55),t._UZ(1,"app-input-error",23),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("control",e.form.get("images"))("fieldName","Images")}}function H(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",56)(2,"div",57)(3,"a",58),t._UZ(4,"img",59),t.qZA(),t.TgZ(5,"div",60),t.NdJ("click",function(){const r=t.CHM(e).index,s=t.oxw(2);return t.KtG(s.removeImage(r))}),t._UZ(6,"i",61),t.qZA()()()()}if(2&i){const e=n.$implicit;t.xp6(3),t.Q6J("href",e,t.LSH),t.xp6(1),t.Q6J("src",e,t.LSH)}}function B(i,n){1&i&&t._UZ(0,"span",62)}function j(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",10)(1,"form",11),t.NdJ("ngSubmit",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onFormSubmit(a.form.value))}),t.TgZ(2,"div",12)(3,"div",13)(4,"div",3)(5,"div",14)(6,"div",15)(7,"label",16),t._uU(8,"Title"),t.qZA(),t._UZ(9,"input",17)(10,"app-input-error",18),t.qZA()(),t.TgZ(11,"div",14)(12,"div",15)(13,"label",16),t._uU(14,"Customized"),t.qZA(),t._UZ(15,"input",19),t.TgZ(16,"label",20),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.updateProductStatus())}),t._uU(17,"checkbox"),t.qZA()()(),t.TgZ(18,"div",21)(19,"div",15)(20,"label",16),t._uU(21,"Short Description"),t.qZA(),t._UZ(22,"angular-editor",22)(23,"app-input-error",23),t.qZA()(),t.TgZ(24,"div",21)(25,"div",15)(26,"label",16),t._uU(27,"Description"),t.qZA(),t._UZ(28,"angular-editor",24)(29,"app-input-error",23),t.qZA()()()()(),t.TgZ(30,"div",12)(31,"div",25)(32,"h5"),t._uU(33,"Categories"),t.qZA()(),t.TgZ(34,"div",13)(35,"div",3)(36,"div",26)(37,"div",15)(38,"label",16),t._uU(39,"Category"),t.qZA(),t.TgZ(40,"ng-select",27,28),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.setSubCategories(a))})("clear",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.clearMainCategory())}),t.YNc(42,w,2,2,"ng-option",29),t.qZA(),t._UZ(43,"app-input-error",23),t.qZA()(),t.TgZ(44,"div",26)(45,"div",15)(46,"label",30),t._uU(47,"Sub Category"),t.qZA(),t.TgZ(48,"ng-select",31,32),t.YNc(50,V,2,2,"ng-option",29),t.qZA(),t._UZ(51,"app-input-error",23),t.qZA()(),t.TgZ(52,"div",26)(53,"div",15)(54,"label",30),t._uU(55,"Brands"),t.qZA(),t.TgZ(56,"ng-select",33,34),t.NdJ("clear",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.clearMainCategory())}),t.YNc(58,G,2,2,"ng-option",29),t.qZA(),t._UZ(59,"app-input-error",23),t.qZA()(),t.TgZ(60,"div",26)(61,"div",15)(62,"label",30),t._uU(63,"Sizes"),t.qZA(),t.TgZ(64,"ng-select",35,28),t.NdJ("clear",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.clearMainCategory())}),t.YNc(66,R,2,2,"ng-option",29),t.qZA(),t._UZ(67,"app-input-error",23),t.qZA()(),t.TgZ(68,"div",26)(69,"label",36),t._uU(70,"quantity"),t.qZA(),t._UZ(71,"input",37),t.qZA(),t.TgZ(72,"div",26)(73,"label",38),t._uU(74,"sellingPrice"),t.qZA(),t._UZ(75,"input",39),t.qZA(),t.TgZ(76,"div",26)(77,"label",40),t._uU(78,"mrp"),t.qZA(),t._UZ(79,"input",41),t.qZA(),t.TgZ(80,"div",26)(81,"label",42),t._uU(82,"color"),t.qZA(),t._UZ(83,"input",43),t.qZA()()()(),t.TgZ(84,"div",12)(85,"div",13)(86,"app-image-guideline")(87,"li"),t._uU(88,"Sample Image: "),t.TgZ(89,"a",44),t._uU(90,"Download Sample Image"),t.qZA()()()()(),t.TgZ(91,"div",12)(92,"div",25)(93,"div",3)(94,"div",4)(95,"h5",5),t._uU(96," Images "),t.qZA()(),t.TgZ(97,"div",6)(98,"input",45,46),t.NdJ("focus",function(){t.CHM(e);const a=t.oxw();let r;return t.KtG(null==(r=a.form.get("images"))?null:r.markAsTouched())})("change",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.chooseFiles(a,"images"))}),t.qZA(),t.TgZ(100,"button",47),t.NdJ("click",function(){t.CHM(e);const a=t.MAs(99);return t.KtG(a.click())}),t._UZ(101,"i",48),t._uU(102," Pick Images "),t.qZA()()()(),t.TgZ(103,"div",13)(104,"div",49),t.YNc(105,K,2,2,"div",50),t.YNc(106,H,7,2,"div",51),t.qZA()()(),t.TgZ(107,"button",52),t.YNc(108,B,1,0,"span",53),t._uU(109," Save "),t.qZA()()()}if(2&i){const e=t.oxw();let o,a,r,s,c,p,m,C;t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(8),t.Q6J("ngClass",null!=(o=e.form.get("name"))&&o.touched?null!=(o=e.form.get("name"))&&o.errors?"is-invalid":"is-valid":""),t.xp6(1),t.Q6J("control",e.form.get("name"))("fieldName","Name")("maxLength",200),t.xp6(5),t.Q6J("ngClass",e.isCustomize?"check active":"check"),t.xp6(7),t.Q6J("ngClass",null!=(a=e.form.get("shortDesc"))&&a.touched?null!=(a=e.form.get("shortDesc"))&&a.errors?"is-invalid":"is-valid":"")("config",e.editorConfig),t.xp6(1),t.Q6J("control",e.form.get("shortDesc"))("fieldName","Description"),t.xp6(5),t.Q6J("ngClass",null!=(r=e.form.get("fullDesc"))&&r.touched?null!=(r=e.form.get("fullDesc"))&&r.errors?"is-invalid":"is-valid":"")("config",e.editorConfig),t.xp6(1),t.Q6J("control",e.form.get("fullDesc"))("fieldName","Description"),t.xp6(11),t.Q6J("ngClass",null!=(s=e.form.get("category"))&&s.touched?null!=(s=e.form.get("category"))&&s.errors?"is-invalid":"is-valid":"")("appendTo","body")("loading",!(null!=e.categories&&e.categories.length))("loadingText","Loading...")("searchable",!0)("notFoundText","No items found.")("placeholder","select category"),t.xp6(2),t.Q6J("ngForOf",e.categories),t.xp6(1),t.Q6J("control",e.form.get("category"))("fieldName","Category"),t.xp6(5),t.Q6J("ngClass",null!=(c=e.form.get("subCategory"))&&c.touched?null!=(c=e.form.get("subCategory"))&&c.errors?"is-invalid":"is-valid":"")("appendTo","body")("loadingText","Loading...")("searchable",!0)("notFoundText","No items found.")("placeholder","select subCategory"),t.xp6(2),t.Q6J("ngForOf",e.subCategories),t.xp6(1),t.Q6J("control",e.form.get("subCategory"))("fieldName","Category"),t.xp6(5),t.Q6J("ngClass",null!=(p=e.form.get("brand"))&&p.touched?null!=(p=e.form.get("brand"))&&p.errors?"is-invalid":"is-valid":"")("appendTo","body")("loadingText","Loading...")("searchable",!0)("notFoundText","No items found.")("placeholder","select brand"),t.xp6(2),t.Q6J("ngForOf",e.brands),t.xp6(1),t.Q6J("control",e.form.get("brand"))("fieldName","Brand"),t.xp6(5),t.Q6J("ngClass",null!=(m=e.form.get("sizes"))&&m.touched?null!=(m=e.form.get("sizes"))&&m.errors?"is-invalid":"is-valid":"")("multiple",!0)("appendTo","body")("loadingText","Loading...")("searchable",!0)("notFoundText","No items found.")("placeholder","select size"),t.xp6(2),t.Q6J("ngForOf",e.sizes),t.xp6(1),t.Q6J("control",e.form.get("sizes"))("fieldName","Brand"),t.xp6(31),t.Q6J("hidden",!0),t.xp6(7),t.Q6J("ngIf",null==(C=e.form.get("images"))?null:C.errors),t.xp6(1),t.Q6J("ngForOf",e.imageSrcs),t.xp6(1),t.Q6J("disabled",e.isFormSubmitted),t.xp6(1),t.Q6J("ngIf",e.isFormSubmitted)}}let $=(()=>{class i{constructor(e,o,a,r,s,c,p,m){this.fb=e,this.uiService=o,this.productService=a,this.categoryService=r,this.brandService=s,this.location=c,this.sharedService=p,this.route=m,this.editorConfig=(0,h.Ob)(),this.isFormSubmitted=!1,this.isCustomize=!1,this.imageSrcs=[],this.subCategories=[],this.sizes=["2.2","2.4","2.6","2.8","2.10","2.12"]}ngOnInit(){this.route.queryParams.subscribe(e=>{(0,N.D)([this.fetchCategories(),this.fetchBrand()]).subscribe(o=>{this.categories=o[0],this.brands=o[1],e.parentId?this.productService.fetchProduct(e.parentId).subscribe(a=>{this.product=a,this.product&&this.setSubCategories(this.product.data.category._id),this.initForm(e.parentId),this.setFormData()}):this.initForm(e.parentId)})})}fetchCategories(){return this.categoryService.fetchCategories().pipe((0,Z.U)(e=>e.data.docs))}fetchBrand(){return this.brandService.getBrands().pipe((0,Z.U)(e=>e.data.docs))}openImageGuideline(){this.uiService.openModal("#ImageGuideline",{modalTitle:"Image GuideLine",points:this.sharedService.imageGuidline}).afterClose.subscribe()}initForm(e){this.form=this.fb.group({parentId:[e],name:["",[d.kI.required,_.Dw]],fullDesc:["",[d.kI.required,_.Dw]],shortDesc:["",[d.kI.required,_.Dw]],brand:[null],category:[null],subCategory:[null],images:this.fb.array([],[d.kI.required]),status:[!0],isCustomize:[!1],quantity:[0],sellingPrice:[0],mrp:[0],sizes:["",[d.kI.required]],color:["",[d.kI.required]]})}setFormData(){this.form.get("name")?.patchValue(this.product?.data.name),this.form.get("fullDesc")?.patchValue(this.product?.data.fullDesc),this.form.get("shortDesc")?.patchValue(this.product?.data.shortDesc),this.form.get("category")?.patchValue(this.product?.data.category._id),this.form.get("brand")?.patchValue(this.product?.data.brand._id),this.form.get("subCategory")?.patchValue(this.product?.data.subCategory._id),this.form.get("status")?.patchValue(this.product?.data.status),this.form.get("quantity")?.patchValue(this.product?.data.quantity),this.form.get("sellingPrice")?.patchValue(this.product?.data.sellingPrice),this.form.get("mrp")?.patchValue(this.product?.data.mrp),this.form.get("sizes")?.patchValue(this.product?.data.sizes),this.form.get("color")?.patchValue(this.product?.data.color)}chooseFiles(e,o){const a=e.target?.files;if(!a)return;let r=this.form.get(o);if(!a?.length&&!r.controls.length)return r.clear(),void this.uiService.openSnackbar("please choose image files");for(let s=0;s<a.length;s++){const c=a[s];if(!c?.type||!h.KL.includes(c.type))return void this.uiService.openSnackbar(h.p1)}for(let s=0;s<a.length;s++){const c=new FileReader;c.onload=p=>this.imageSrcs.push(c.result),c.readAsDataURL(a[s])}(0,F.r)(e,o,this.form)}removeImage(e){this.imageSrcs.splice(e,1),this.form.get("images").removeAt(e)}onFormSubmit(e){var o=this;return(0,S.Z)(function*(){console.log({formData:e}),o.form.get("isCustomize")?.patchValue(o.isCustomize);let a=o.form.getRawValue();if(o.form.invalid)return o.form.markAllAsTouched();o.isFormSubmitted=!0;try{let r=yield o.productService.addProduct(a);o.uiService.openSnackbar(r.message),o.location.back()}catch{}finally{o.isFormSubmitted=!1}})()}setSubCategories(e){!e||(this.form?.get("subCategory")?.patchValue(null),this.subCategories=[],e&&this.categories?.forEach(o=>{o._id==e&&(this.subCategories=o.subCategories||[])}))}clearMainCategory(){this.form.get("subCategory")?.patchValue(null),this.subCategories=[]}updateProductStatus(){this.isCustomize=!this.isCustomize,console.log(this.isCustomize)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.qu),t.Y36(v.F),t.Y36(f.M),t.Y36(U.G),t.Y36(M.c),t.Y36(u.Ye),t.Y36(k.F),t.Y36(g.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-add-product"]],decls:15,vars:1,consts:[[1,"page-wrapper"],[1,"content","container-fluid"],[1,"page-header"],[1,"row"],[1,"col-sm-7","col-auto"],[1,"page-title"],[1,"col-sm-5","col"],[1,"btn","btn-primary","btn-sm","float-right","mt-2",3,"click"],[1,"fa","fa-arrow-left"],["class","col-sm-12",4,"ngIf"],[1,"col-sm-12"],[3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"col-6","col-md-6"],[1,"form-group"],["for","validationServer01",1,"required-label"],["maxlength","200","type","text","id","validationServer01","placeholder","Name","required","","formControlName","name",1,"form-control",3,"ngClass"],[3,"control","fieldName","maxLength"],["type","checkbox","id","status_1",1,"check",3,"ngClass"],["for","status_1",1,"checktoggle",3,"click"],[1,"col-md-12"],["id","editor1","formControlName","shortDesc",3,"ngClass","config"],[3,"control","fieldName"],["id","editor2","formControlName","fullDesc",3,"ngClass","config"],[1,"card-header"],[1,"col-md-4"],["formControlName","category",3,"ngClass","appendTo","loading","loadingText","searchable","notFoundText","placeholder","change","clear"],["col",""],[3,"value",4,"ngFor","ngForOf"],["for","validationServer01"],["formControlName","subCategory",3,"ngClass","appendTo","loadingText","searchable","notFoundText","placeholder"],["col2",""],["formControlName","brand",3,"ngClass","appendTo","loadingText","searchable","notFoundText","placeholder","clear"],["col3",""],["formControlName","sizes",3,"ngClass","multiple","appendTo","loadingText","searchable","notFoundText","placeholder","clear"],["for","quantity"],["type","number","formControlName","quantity","placeholder","quantity",1,"form-control"],["for","sellingPrice"],["type","number","formControlName","sellingPrice","placeholder","sellingPrice",1,"form-control"],["for","mrp"],["type","number","formControlName","mrp","placeholder","mrp",1,"form-control"],["for","color"],["type","text","formControlName","color","placeholder","color",1,"form-control"],["download","assets/img/ADD-PRODUCT.png","href","assets/img/ADD-PRODUCT.png"],["multiple","","type","file","accept","image/*","id","validationServer02",1,"form-control",3,"hidden","focus","change"],["images",""],["type","button",1,"btn","btn-primary","btn-sm","float-right","mt-2",3,"click"],[1,"fa","fa-upload"],[1,"row","m-1"],["class","col-12",4,"ngIf"],[4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary","float-right",3,"disabled"],["class","spinner-border spinner-border-sm mr-2","role","status",4,"ngIf"],[3,"value"],[1,"col-12"],[1,"d-flex","align-content-start","pt-2"],[1,"d-flex"],["data-fancybox","gallery",3,"href"],[1,"img-thumbnail",2,"height","100px",3,"src"],[1,"mb-1","cursor","trashImage",3,"click"],[1,"fa","fa-trash-o","text-danger"],["role","status",1,"spinner-border","spinner-border-sm","mr-2"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),t._uU(6,"Add Product"),t.qZA()(),t.TgZ(7,"div",6)(8,"button",7),t.NdJ("click",function(){return o.location.back()}),t._UZ(9,"i",8),t._uU(10," Back"),t.qZA()()()(),t.TgZ(11,"div",3),t.YNc(12,j,110,57,"div",9),t.qZA(),t._UZ(13,"br")(14,"br"),t.qZA()()),2&e&&(t.xp6(12),t.Q6J("ngIf",o.form))},dependencies:[u.mk,u.sg,u.O5,d._Y,d.Fj,d.wV,d.JJ,d.JL,d.Q7,d.nD,d.sg,d.u,Q.w,y.s6,b.w9,b.jq,L.I],styles:[".example-chip-list[_ngcontent-%COMP%]{width:100%}  .mat-primary .mat-option.mat-selected:not(.mat-option-disabled){color:unset}  .mat-option-pseudo-checkbox.mat-pseudo-checkbox-checked{background-color:#007bff}.trashImage[_ngcontent-%COMP%]{position:relative;right:25px;background:black;height:min-content;padding:0 6px}.variantWidth[_ngcontent-%COMP%]{width:200px}.variantInput[_ngcontent-%COMP%]{min-width:200px;max-width:100%}.mat-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]{margin:0!important}.mat-form-field-wrapper[_ngcontent-%COMP%]{padding-bottom:0!important}"]}),i})();var E=l(7341),X=l(6129),W=l(8446),tt=l(6172),P=l(3162),et=l(4724);function ot(i,n){1&i&&t._UZ(0,"mat-progress-bar",13)}function it(i,n){1&i&&(t.TgZ(0,"div"),t._uU(1," No Collections Available. "),t.qZA())}const at=function(i){return["/collections","products",i]};function rt(i,n){if(1&i&&(t.TgZ(0,"li",16)(1,"a",17)(2,"h5"),t._uU(3),t.qZA()()()),2&i){const e=n.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,at,e._id)),t.xp6(2),t.Oqu(e.title)}}function nt(i,n){if(1&i&&(t.TgZ(0,"ul",14),t.YNc(1,rt,4,4,"li",15),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.coll)}}let st=(()=>{class i{constructor(e,o){this.productService=e,this.uiService=o,this.coll=[],this.loading=!0}ngOnInit(){this.subscription=this.uiService.onModalDataChange().subscribe(e=>{this.loading=!0,e&&e?.productId&&"COLLECTION"==e.type&&this.productService.getCollections(e.productId).subscribe(o=>{this.coll=o.data,this.loading=!1})})}onModalClose(e){this.uiService.closeModal("#coll_modal",e),this.loading=!0}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.M),t.Y36(v.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-products-collection"]],decls:17,vars:3,consts:[["id","coll_modal","aria-hidden","true","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-content","p-2"],["mode","indeterminate",4,"ngIf"],[4,"ngIf"],["class","list-group",4,"ngIf"],["type","button",1,"btn","btn-primary","float-right",3,"click"],["mode","indeterminate"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],["data-dismiss","modal","aria-label","Close",3,"routerLink"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),t._uU(5,"Product's Collections"),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){return o.onModalClose(!1)}),t.TgZ(7,"span",6),t._uU(8,"\xd7"),t.qZA()()(),t.TgZ(9,"div",7)(10,"div",8),t.YNc(11,ot,1,0,"mat-progress-bar",9),t.YNc(12,it,2,0,"div",10),t.YNc(13,nt,2,1,"ul",11),t._UZ(14,"br"),t.TgZ(15,"button",12),t.NdJ("click",function(){return o.onModalClose(!1)}),t._uU(16," Close "),t.qZA()()()()()()),2&e&&(t.xp6(11),t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading&&0==o.coll.length),t.xp6(1),t.Q6J("ngIf",!o.loading&&o.coll.length>0))},dependencies:[u.sg,u.O5,g.yS,P.pW]}),i})();function lt(i,n){1&i&&t._UZ(0,"span",14)}let dt=(()=>{class i{constructor(e,o,a){this.fb=e,this.productService=o,this.uiService=a,this.isFormSubmitted=!1,this.rating=0}ngOnInit(){this.initForm()}onModalClose(e){this.uiService.closeModal("#Add_Rating",{rating:this.rating,status:e})}initForm(){this.form=this.fb.group({productId:[null],rating:[null,[d.kI.required,d.kI.maxLength(50)]]}),this.uiService.onModalDataChange().subscribe(e=>{e?.productId&&(this.rating=e.rating,this.form.get("productId")?.patchValue(e.productId),this.form.get("rating")?.patchValue(this.rating))})}onChangeRate(e){this.rating=e.newValue,this.form.get("rating")?.patchValue(this.rating)}onFormSubmit(e){var o=this;return(0,S.Z)(function*(){if(o.form.invalid)o.form.markAllAsTouched();else{o.isFormSubmitted=!0;try{let a=yield o.productService.updateProductRating(e.productId,e.rating);o.uiService.openSnackbar(a.message),o.onModalClose(!0),o.form.reset({status:!1})}catch{}finally{o.isFormSubmitted=!1}}})()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.qu),t.Y36(f.M),t.Y36(v.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-update-rating"]],decls:18,vars:5,consts:[["id","Add_Rating","aria-hidden","true","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["id","categoryButton","type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-12","text-center"],["checkedcolor","#e6a729","uncheckedcolor","grey","size","50px",3,"value","totalstars","rate"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],["class","spinner-border spinner-border-sm mr-2","role","status",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","mr-2"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),t._uU(5,"Rating"),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){return o.onModalClose(!1)}),t.TgZ(7,"span",6),t._uU(8,"\xd7"),t.qZA()()(),t.TgZ(9,"div",7)(10,"form",8),t.NdJ("ngSubmit",function(){return o.onFormSubmit(o.form.value)}),t.TgZ(11,"div",9)(12,"div",10)(13,"star-rating",11),t.NdJ("rate",function(r){return o.onChangeRate(r)}),t.qZA()()(),t._UZ(14,"br"),t.TgZ(15,"button",12),t.YNc(16,lt,1,0,"span",13),t._uU(17," Save "),t.qZA()()()()()()),2&e&&(t.xp6(10),t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("value",o.rating)("totalstars",5),t.xp6(2),t.Q6J("disabled",o.isFormSubmitted),t.xp6(1),t.Q6J("ngIf",o.isFormSubmitted))},dependencies:[u.O5,d._Y,d.JL,d.sg,x.Te]}),i})();var ct=l(5144);const z=function(){return["add"]},ut=function(){return{mode:"ADD-PRODUCT"}};function pt(i,n){1&i&&(t.ynx(0),t.TgZ(1,"button",20),t._UZ(2,"i",21),t._uU(3," Add "),t.qZA(),t.BQk()),2&i&&(t.xp6(1),t.Q6J("routerLink",t.DdM(2,z))("queryParams",t.DdM(3,ut)))}function mt(i,n){1&i&&(t.TgZ(0,"div",22)(1,"b"),t._uU(2,"Unauthorize Access."),t.qZA()())}function gt(i,n){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ( ",e.variants.length,") ")}}function ft(i,n){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"star-rating",47),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.rating)("totalstars",5)("readonly",!0)}}function ht(i,n){if(1&i&&(t.TgZ(0,"span"),t._UZ(1,"star-rating",47),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("value",e.rating)("totalstars",5)("readonly",!0)}}const _t=function(i){return{mode:"ADD-VARIANT",parentId:i}};function vt(i,n){if(1&i&&(t.TgZ(0,"button",48),t._UZ(1,"i",49),t._uU(2," Variants "),t.qZA()),2&i){const e=t.oxw().$implicit;t.Q6J("routerLink",t.DdM(2,z))("queryParams",t.VKq(3,_t,e._id))}}const Y=function(i){return["/products/update",i]},q=function(){return{mode:"VIEW"}},bt=function(i){return["/brands/update",i]},Ct=function(i){return["update",i]};function Zt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"tr",29)(1,"td",30)(2,"h2",31)(3,"a",32),t._UZ(4,"img",33),t.qZA(),t.TgZ(5,"a",34),t._uU(6),t.ALo(7,"elipsis"),t.YNc(8,gt,2,1,"span",7),t.YNc(9,ft,2,3,"span",7),t.YNc(10,ht,2,3,"span",7),t.qZA()()(),t.TgZ(11,"td")(12,"div",35),t._UZ(13,"input",36),t.TgZ(14,"label",37),t.NdJ("click",function(){const r=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.updateProductStatus(r._id,r.status))}),t._uU(15,"checkbox"),t.qZA()()(),t.TgZ(16,"td",38),t._uU(17),t.qZA(),t.TgZ(18,"td"),t._uU(19),t.qZA(),t.TgZ(20,"td"),t._uU(21),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.ALo(24,"date"),t.qZA(),t.TgZ(25,"td",27)(26,"div",39)(27,"button",40),t.NdJ("click",function(){const r=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.updateProductRating(r._id,r.rating))}),t._UZ(28,"i",41),t._uU(29," Rate "),t.qZA(),t.YNc(30,vt,3,5,"button",42),t.TgZ(31,"button",43),t._UZ(32,"i",44),t._uU(33," Edit "),t.qZA(),t.TgZ(34,"button",45),t.NdJ("click",function(){const r=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.onDelete(r))}),t._UZ(35,"i",46),t._uU(36," Delete "),t.qZA()()()()}if(2&i){const e=n.$implicit;t.Q6J("ngClass",n.index%2==0?"even":"odd"),t.xp6(3),t.Q6J("routerLink",t.VKq(26,Y,null==e?null:e._id))("queryParams",t.DdM(28,q)),t.xp6(1),t.Q6J("alt",e.name)("src",e.images[0]||"assets/img/patients/patient.jpg",t.LSH),t.xp6(1),t.Q6J("title",e.name)("routerLink",t.VKq(29,Y,e.slug))("queryParams",t.DdM(31,q)),t.xp6(1),t.hij("",t.lcZ(7,21,e.name)," "),t.xp6(2),t.Q6J("ngIf",e.variants.length&&!e.parentId),t.xp6(1),t.Q6J("ngIf",e.rating),t.xp6(1),t.Q6J("ngIf",!e.rating),t.xp6(3),t.Q6J("ngClass",e.status?"check active":"check"),t.xp6(3),t.Q6J("routerLink",t.VKq(32,bt,null==e||null==e.brand?null:e.brand._id))("queryParams",t.DdM(34,q)),t.xp6(1),t.hij(" ",(null==e||null==e.brand?null:e.brand.brandName)||"N/A"," "),t.xp6(2),t.Oqu(null==e.category?null:e.category.name),t.xp6(2),t.Oqu(null==e.subCategory?null:e.subCategory.name),t.xp6(2),t.Oqu(t.xi3(24,23,e.createdAt,"d MMM, y")),t.xp6(7),t.Q6J("ngIf",!e.parentId),t.xp6(1),t.Q6J("routerLink",t.VKq(35,Ct,e._id))}}function Tt(i,n){if(1&i&&(t.TgZ(0,"div",3)(1,"div",8)(2,"div",23)(3,"table",24)(4,"thead")(5,"tr",25)(6,"th"),t._uU(7,"Name"),t.qZA(),t.TgZ(8,"th",26),t._uU(9,"Active Status"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Brand"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Category"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Sub Category"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Created At"),t.qZA(),t.TgZ(18,"th",27),t._uU(19,"Actions \xa0"),t.qZA()()(),t.TgZ(20,"tbody"),t.YNc(21,Zt,37,37,"tr",28),t.qZA()()()()()),2&i){const e=t.oxw();t.xp6(21),t.Q6J("ngForOf",null==e.pageData||null==e.pageData.data?null:e.pageData.data.docs)}}function xt(i,n){1&i&&t._UZ(0,"mat-progress-bar",50)}function At(i,n){if(1&i&&(t.ynx(0),t._UZ(1,"app-pagination",51),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("route","/products")("pageData",e.pageData.data)("pageSize",e.pageSize)("currentPage",e.page)}}let yt=(()=>{class i{constructor(e,o,a,r,s){this.productService=e,this.uiService=o,this.route=a,this.fb=r,this.authService=s,this.approvalStatus=T.Kb,this.dataIsLoaded=!1,this.page=1,this.pageSize=10,this.vendors=[],this.filters=[],this.showFilter=!1,this.isFilterApplied=!1,this.coll=[],this.authData=null,this.adminModules=T.W5}ngOnInit(){this.authData=this.authService.getAuthData,this.route.queryParams.subscribe(e=>{this.dataIsLoaded=!1,this.page=+e.page?+e.page:this.page,this.pageSize=+e.pageSize?+e.pageSize:this.pageSize,this.initForm(),this.fetchProducts()})}haveAccess(e,o){return(o?.adminRole?.permissions||[])?.findIndex(a=>a.module==T.W5.PRICE&&a[e])>=0||o?.role==T.xZ.SUPER_ADMIN}initForm(){let e=localStorage.getItem("productFilter"),o={status:[!0],createdAt:[null],isApproved:[null],vendor:[null],filterBy:[null]};if(e){this.isFilterApplied=!0;let a=JSON.parse(e);o.status=["null"==a.status||a.status],o.createdAt=["null"!=a.createdAt?a.createdAt:null],o.isApproved=["null"!=a.isApproved?a.isApproved:null],o.vendor=["null"!=a.vendor?a.vendor:null],o.filterBy=["null"!=a.filterBy?a.filterBy:null]}this.filterForm=this.fb.group(o)}applyFilter(e){this.isFilterApplied=!0,this.page=1,localStorage.setItem("productFilter",JSON.stringify(e)),this.fetchProducts()}clearFilter(){this.filterForm.reset({status:!0}),this.isFilterApplied=!1,localStorage.removeItem("productFilter"),this.fetchProducts()}onChangePageSize(e){this.dataIsLoaded=!1,this.pageSize=+e.target.value,this.fetchProducts()}prices(e){return e.map(o=>o.variant.sellingPrice)}fetchProducts(){!this.haveAccess("read",this.authData)||(this.dataIsLoaded=!1,this.productService.fetchProducts(this.textSearch,this.page,this.pageSize,this.isFilterApplied,this.filterForm?.value).subscribe(e=>{this.pageData=e,this.dataIsLoaded=!0},e=>{this.dataIsLoaded=!1}))}onSearch(e){this.textSearch=e,this.page=1,this.fetchProducts()}updateProductStatus(e,o){this.productService.updateProductStatus(e,o).subscribe(a=>{this.pageData.data.docs=this.pageData.data.docs.map(r=>(r._id==e&&(r.status=!o),r)),this.uiService.openSnackbar(a.message)})}updateProductFeatureStatus(e,o){this.uiService.openModal("#delete_modal",{modalTitle:"Update"}).afterClose.subscribe(a=>{!a||this.productService.updateProductFeatureStatus(e,o).subscribe(r=>{this.pageData.data.docs=this.pageData.data.docs.map(s=>(s._id==e&&(s.isFeatured=o),s)),this.uiService.openSnackbar(r.message)})})}onDelete(e){this.uiService.openModal("#delete_modal").afterClose.subscribe(o=>{o&&(this.dataIsLoaded=!1,this.productService.deleteProduct(e._id).subscribe(a=>{this.fetchProducts(),this.uiService.openSnackbar(a.message),this.uiService.closeModal("#delete_modal",!0)},a=>this.dataIsLoaded=!0))})}updateProductRating(e,o){this.uiService.openModal("#Add_Rating",{productId:e,adminRating:o}).afterClose.subscribe(a=>{a.status&&this.fetchProducts()})}loadErpProducts(){this.productService.loadErpProducts().then(e=>this.uiService.openSnackbar(e.message)).catch(e=>this.uiService.openSnackbar(e.message))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.M),t.Y36(v.F),t.Y36(g.gz),t.Y36(d.qu),t.Y36(E.e))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-list-product"]],decls:26,vars:7,consts:[[1,"page-wrapper"],[1,"content","container-fluid"],[1,"page-header"],[1,"row"],[1,"col-sm-7","col-auto"],[1,"page-title"],[1,"col-sm-5","col"],[4,"ngIf"],[1,"col-sm-12"],[1,"card"],[1,"card-body"],["id","DataTables_Table_0_wrapper",1,"dataTables_wrapper","dt-bootstrap4","no-footer"],[1,"row","w-100"],[1,"app-pagesize-dropdown","col",3,"pageSize","selectedPageSize"],[1,"col"],[1,"d-flex","align-content-center","float-right"],[1,"float-lg-right",3,"placeholder","inputText"],["class","text-center text-danger",4,"ngIf"],["class","row",4,"ngIf"],["mode","indeterminate",4,"ngIf"],[1,"btn","btn-primary","btn-sm","float-right","mt-2",3,"routerLink","queryParams"],[1,"fa","fa-plus"],[1,"text-center","text-danger"],[1,"table-responsive"],["id","DataTables_Table_0","role","grid","aria-describedby","DataTables_Table_0_info",1,"table","table-hover","table-center","mb-0","dataTable","no-footer","table-bordered","table-bordered"],["role","row"],[1,"text-center"],[1,"text-right"],["role","row",3,"ngClass",4,"ngFor","ngForOf"],["role","row",3,"ngClass"],[1,"sorting_1"],[1,"table-avatar"],[1,"avatar","mr-2",3,"routerLink","queryParams"],[1,"avatar-img","rounded-circle",3,"alt","src"],[3,"title","routerLink","queryParams"],[1,"d-flex","justify-content-center"],["type","checkbox","id","status_1",3,"ngClass"],["for","status_1",1,"checktoggle",3,"click"],[1,"cursor",3,"routerLink","queryParams"],[1,"actions"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"fe","fe-star"],["class","btn btn-sm btn-outline-primary",3,"routerLink","queryParams",4,"ngIf"],["data-toggle","modal",1,"btn","btn-sm","btn-outline-success",3,"routerLink"],[1,"fe","fe-pencil"],["data-toggle","modal",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fe","fe-trash"],["checkedcolor","#e6a729","uncheckedcolor","grey","size","14px",3,"value","totalstars","readonly"],[1,"btn","btn-sm","btn-outline-primary",3,"routerLink","queryParams"],[1,"fe","fe-columns"],["mode","indeterminate"],[1,"row","p-2",3,"route","pageData","pageSize","currentPage"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),t._uU(6,"Products"),t.qZA()(),t.TgZ(7,"div",6),t.YNc(8,pt,4,4,"ng-container",7),t.qZA()()(),t.TgZ(9,"div",3)(10,"div",8)(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"div",13),t.NdJ("selectedPageSize",function(r){return o.onChangePageSize(r)}),t.qZA(),t.TgZ(16,"div",14)(17,"div",15)(18,"app-search-input",16),t.NdJ("inputText",function(r){return o.onSearch(r)}),t.qZA()()()(),t.YNc(19,mt,3,0,"div",17),t.YNc(20,Tt,22,1,"div",18),t.YNc(21,xt,1,0,"mat-progress-bar",19),t.qZA(),t.YNc(22,At,2,4,"ng-container",7),t.qZA()()()()()(),t._UZ(23,"app-delete-modal")(24,"app-products-collection")(25,"app-update-rating")),2&e&&(t.xp6(8),t.Q6J("ngIf",o.haveAccess("write",o.authData)),t.xp6(7),t.Q6J("pageSize",o.pageSize),t.xp6(3),t.Q6J("placeholder","Search Product Name"),t.xp6(1),t.Q6J("ngIf",!o.haveAccess("read",o.authData)),t.xp6(1),t.Q6J("ngIf",o.dataIsLoaded&&o.haveAccess("read",o.authData)),t.xp6(1),t.Q6J("ngIf",!o.dataIsLoaded&&o.haveAccess("read",o.authData)),t.xp6(1),t.Q6J("ngIf",o.dataIsLoaded))},dependencies:[u.mk,u.sg,u.O5,g.rH,g.yS,X.z,W.Q,tt.C,P.pW,et.J,x.Te,st,dt,u.uU,ct.p],styles:[".avatar[_ngcontent-%COMP%] > img[_ngcontent-%COMP%]{object-fit:cover}"]}),i})();var Ut=l(1952),St=l.n(Ut);function Pt(i,n){if(1&i&&(t.TgZ(0,"li",10)(1,"b"),t._uU(2),t.qZA(),t._uU(3),t.qZA()),2&i){const e=n.$implicit;t.xp6(2),t.Oqu(e.key),t.xp6(1),t.hij(" : ",e.value," ")}}let qt=(()=>{class i{constructor(e){this.uiService=e}ngOnInit(){this.uiService.onModalDataChange().subscribe(e=>{this.modelInfo=e})}onModalClose(e){this.uiService.closeModal("#ImageGuideline")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(v.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-info-modal"]],decls:12,vars:2,consts:[["id","ImageGuideline","aria-hidden","true","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["id","categoryButton","type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),t._uU(5),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){return o.onModalClose(!1)}),t.TgZ(7,"span",6),t._uU(8,"\xd7"),t.qZA()()(),t.TgZ(9,"div",7)(10,"ul",8),t.YNc(11,Pt,4,2,"li",9),t.qZA()()()()()),2&e&&(t.xp6(5),t.Oqu(null!=o.modelInfo&&o.modelInfo.modalTitle?null==o.modelInfo?null:o.modelInfo.modalTitle:"Delete"),t.xp6(6),t.Q6J("ngForOf",null==o.modelInfo?null:o.modelInfo.points))},dependencies:[u.sg]}),i})();function Jt(i,n){if(1&i&&(t.TgZ(0,"ng-option",58),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function It(i,n){if(1&i&&(t.TgZ(0,"ng-option",58),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function Dt(i,n){if(1&i&&(t.TgZ(0,"ng-option",58),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",null==e?null:e.brandName," ")}}function Nt(i,n){if(1&i&&(t.TgZ(0,"ng-option",58),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",e," ")}}function Ft(i,n){if(1&i&&(t.TgZ(0,"div",59),t._UZ(1,"app-input-error",26),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("control",e.form.get("images"))("fieldName","Images")}}function Mt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",60)(2,"div",61)(3,"div",62)(4,"a",63),t._UZ(5,"img",64),t.qZA(),t.TgZ(6,"div",65),t.NdJ("click",function(){const a=t.CHM(e),r=a.index,s=a.$implicit,c=t.oxw(2);return t.KtG(c.removeImage(r,s))}),t._UZ(7,"i",66),t.qZA()()()()()}if(2&i){const e=n.$implicit;t.xp6(4),t.Q6J("href",e,t.LSH),t.xp6(1),t.Q6J("src",e,t.LSH)}}function kt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",60)(2,"div",61)(3,"div",62)(4,"a",63),t._UZ(5,"img",64),t.qZA(),t.TgZ(6,"div",65),t.NdJ("click",function(){const a=t.CHM(e),r=a.index,s=a.$implicit,c=t.oxw(2);return t.KtG(c.removeImage(r,s))}),t._UZ(7,"i",66),t.qZA()()()()()}if(2&i){const e=n.$implicit;t.xp6(4),t.Q6J("href",e,t.LSH),t.xp6(1),t.Q6J("src",e,t.LSH)}}function Qt(i,n){1&i&&t._UZ(0,"span",67)}function Lt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",12)(1,"form",13),t.NdJ("ngSubmit",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onFormSubmit(a.form.value))}),t.TgZ(2,"div",14)(3,"div",15)(4,"div",3)(5,"div",16)(6,"div",17)(7,"label",18),t._uU(8,"Title"),t.qZA(),t._UZ(9,"input",19)(10,"app-input-error",20),t.qZA()(),t.TgZ(11,"div",21)(12,"div",17)(13,"label",18),t._uU(14,"Customized"),t.qZA(),t._UZ(15,"input",22),t.TgZ(16,"label",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.updateProductStatus())}),t._uU(17,"checkbox"),t.qZA()()(),t.TgZ(18,"div",24)(19,"div",17)(20,"label",18),t._uU(21,"Short Description"),t.qZA(),t._UZ(22,"angular-editor",25)(23,"app-input-error",26),t.qZA()(),t.TgZ(24,"div",24)(25,"div",17)(26,"label",18),t._uU(27,"Description"),t.qZA(),t._UZ(28,"angular-editor",27)(29,"app-input-error",26),t.qZA()()()()(),t.TgZ(30,"div",14)(31,"div",28)(32,"h5"),t._uU(33,"Categories"),t.qZA()(),t.TgZ(34,"div",15)(35,"div",3)(36,"div",29)(37,"div",17)(38,"label",18),t._uU(39,"Category"),t.qZA(),t.TgZ(40,"ng-select",30,31),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.setSubCategories(a))})("clear",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.clearMainCategory())}),t.YNc(42,Jt,2,2,"ng-option",32),t.qZA(),t._UZ(43,"app-input-error",26),t.qZA()(),t.TgZ(44,"div",29)(45,"div",17)(46,"label",33),t._uU(47,"Sub Category"),t.qZA(),t.TgZ(48,"ng-select",34,35),t.YNc(50,It,2,2,"ng-option",32),t.qZA(),t._UZ(51,"app-input-error",26),t.qZA()(),t.TgZ(52,"div",29)(53,"div",17)(54,"label",33),t._uU(55,"Brands"),t.qZA(),t.TgZ(56,"ng-select",36,37),t.NdJ("clear",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.clearMainCategory())}),t.YNc(58,Dt,2,2,"ng-option",32),t.qZA(),t._UZ(59,"app-input-error",26),t.qZA()(),t.TgZ(60,"div",29)(61,"div",17)(62,"label",33),t._uU(63,"Sizes"),t.qZA(),t.TgZ(64,"ng-select",38,31),t.NdJ("clear",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.clearMainCategory())}),t.YNc(66,Nt,2,2,"ng-option",32),t.qZA(),t._UZ(67,"app-input-error",26),t.qZA()(),t.TgZ(68,"div",29)(69,"label",39),t._uU(70,"quantity"),t.qZA(),t._UZ(71,"input",40),t.qZA(),t.TgZ(72,"div",29)(73,"label",41),t._uU(74,"sellingPrice"),t.qZA(),t._UZ(75,"input",42),t.qZA(),t.TgZ(76,"div",29)(77,"label",43),t._uU(78,"mrp"),t.qZA(),t._UZ(79,"input",44),t.qZA(),t.TgZ(80,"div",29)(81,"label",45),t._uU(82,"color"),t.qZA(),t._UZ(83,"input",46),t.qZA()()()(),t.TgZ(84,"div",14)(85,"div",15)(86,"app-image-guideline")(87,"li"),t._uU(88,"Sample Image: "),t.TgZ(89,"a",47),t._uU(90,"Download Sample Image"),t.qZA()()()()(),t.TgZ(91,"div",14)(92,"div",28)(93,"div",3)(94,"div",4),t._uU(95," Images "),t.TgZ(96,"a",48),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.openImageGuideline())}),t._uU(97,"Guideline?"),t.qZA()(),t.TgZ(98,"div",6)(99,"input",49,50),t.NdJ("focus",function(){t.CHM(e);const a=t.oxw();let r;return t.KtG(null==(r=a.form.get("images"))?null:r.markAsTouched())})("change",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.chooseFiles(a,"images"))}),t.qZA(),t.TgZ(101,"button",51),t.NdJ("click",function(){t.CHM(e);const a=t.MAs(100);return t.KtG(a.click())}),t._UZ(102,"i",52),t._uU(103," Pick Images "),t.qZA()()()(),t.TgZ(104,"div",15)(105,"div",53),t.YNc(106,Ft,2,2,"div",54),t.YNc(107,Mt,8,2,"div",55),t.YNc(108,kt,8,2,"div",55),t.qZA()()(),t.TgZ(109,"button",56),t.YNc(110,Qt,1,0,"span",57),t._uU(111," Save "),t.qZA()()()}if(2&i){const e=t.oxw();let o,a,r,s,c,p,m,C;t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(8),t.Q6J("ngClass",null!=(o=e.form.get("name"))&&o.touched?null!=(o=e.form.get("name"))&&o.errors?"is-invalid":"is-valid":""),t.xp6(1),t.Q6J("control",e.form.get("name"))("fieldName","Name")("maxLength",200),t.xp6(5),t.Q6J("ngClass",e.isCustomize?"check active":"check"),t.xp6(7),t.Q6J("ngClass",null!=(a=e.form.get("shortDesc"))&&a.touched?null!=(a=e.form.get("shortDesc"))&&a.errors?"is-invalid":"is-valid":"")("config",e.editorConfig),t.xp6(1),t.Q6J("control",e.form.get("shortDesc"))("fieldName","Description"),t.xp6(5),t.Q6J("ngClass",null!=(r=e.form.get("fullDesc"))&&r.touched?null!=(r=e.form.get("fullDesc"))&&r.errors?"is-invalid":"is-valid":"")("config",e.editorConfig),t.xp6(1),t.Q6J("control",e.form.get("fullDesc"))("fieldName","Description"),t.xp6(11),t.Q6J("ngClass",null!=(s=e.form.get("category"))&&s.touched?null!=(s=e.form.get("category"))&&s.errors?"is-invalid":"is-valid":"")("appendTo","body")("loading",!(null!=e.categories&&e.categories.length))("loadingText","Loading...")("searchable",!0)("notFoundText","No items found.")("placeholder","select category"),t.xp6(2),t.Q6J("ngForOf",e.categories),t.xp6(1),t.Q6J("control",e.form.get("category"))("fieldName","Category"),t.xp6(5),t.Q6J("ngClass",null!=(c=e.form.get("subCategory"))&&c.touched?null!=(c=e.form.get("subCategory"))&&c.errors?"is-invalid":"is-valid":"")("appendTo","body")("loadingText","Loading...")("searchable",!0)("notFoundText","No items found.")("placeholder","select subCategory"),t.xp6(2),t.Q6J("ngForOf",e.subCategories),t.xp6(1),t.Q6J("control",e.form.get("subCategory"))("fieldName","Category"),t.xp6(5),t.Q6J("ngClass",null!=(p=e.form.get("brand"))&&p.touched?null!=(p=e.form.get("brand"))&&p.errors?"is-invalid":"is-valid":"")("appendTo","body")("loadingText","Loading...")("searchable",!0)("notFoundText","No items found.")("placeholder","select brand"),t.xp6(2),t.Q6J("ngForOf",e.brands),t.xp6(1),t.Q6J("control",e.form.get("brand"))("fieldName","Brand"),t.xp6(5),t.Q6J("ngClass",null!=(m=e.form.get("sizes"))&&m.touched?null!=(m=e.form.get("sizes"))&&m.errors?"is-invalid":"is-valid":"")("multiple",!0)("appendTo","body")("loadingText","Loading...")("searchable",!0)("notFoundText","No items found.")("placeholder","select size"),t.xp6(2),t.Q6J("ngForOf",e.sizes),t.xp6(1),t.Q6J("control",e.form.get("sizes"))("fieldName","Brand"),t.xp6(32),t.Q6J("hidden",!0),t.xp6(7),t.Q6J("ngIf",null==(C=e.form.get("images"))?null:C.errors),t.xp6(1),t.Q6J("ngForOf",e.productData.data.images),t.xp6(1),t.Q6J("ngForOf",e.imageSrcs),t.xp6(1),t.Q6J("disabled",e.isFormSubmitted),t.xp6(1),t.Q6J("ngIf",e.isFormSubmitted)}}function zt(i,n){1&i&&(t.TgZ(0,"div",15),t._UZ(1,"mat-progress-bar",68),t.qZA())}const Yt=[{path:"",component:yt},{path:"add",component:$},{path:"update/:productId",component:(()=>{class i{constructor(e,o,a,r,s,c,p,m){this.route=e,this.fb=o,this.productService=a,this.categoryService=r,this.brandService=s,this.uiService=c,this.location=p,this.sharedService=m,this.editorConfig=(0,h.Ob)(),this.isFormSubmitted=!1,this.isCustomize=!1,this.dataIsLoaded=!1,this.imageSrcs=[],this.deletedImages=[],this.subCategories=[],this.sizes=["2.2","2.4","2.6","2.8","2.10","2.12"]}ngOnInit(){this.route.params.subscribe(e=>{e.productId&&(this.subscription=this.productService.fetchProduct(e.productId).subscribe(o=>{this.productData=o,this.productData.data.images=this.productData.data.images,this.isCustomize=this.productData.data.isCustomize,(0,N.D)([this.fetchCategories(),this.fetchBrand()]).subscribe(a=>{this.categories=a[0]||[],this.brands=a[1]||[],this.setSubCategories(this.productData.data.category?._id),this.initform(),this.setFormData(),this.dataIsLoaded=!0})}))})}fetchCategories(){return this.categoryService.fetchCategories().pipe((0,Z.U)(e=>e.data.docs))}fetchBrand(){return this.brandService.getBrands().pipe((0,Z.U)(e=>e.data.docs))}initform(){this.form=this.fb.group({name:["",[d.kI.required,_.Dw]],fullDesc:["",[d.kI.required,_.Dw]],shortDesc:["",[d.kI.required,_.Dw]],brand:[null],category:[null],subCategory:[null],images:this.fb.array([]),status:[!0],isCustomize:[!0],quantity:[0],sellingPrice:[0],mrp:[0],sizes:["",[d.kI.required]],color:["",[d.kI.required]]})}chooseFiles(e,o){const a=e.target?.files;if(!a?.length)return this.uiService.openSnackbar("please choose image files"),void this.form.get(o).clear();for(let r=0;r<a.length;r++){const s=a[r];if(!s?.type||!h.KL.includes(s.type))return this.uiService.openSnackbar(h.p1)}for(let r=0;r<a.length;r++){const s=new FileReader;s.onload=c=>this.imageSrcs.push(s.result),s.readAsDataURL(a[r])}this.form.get(o)?.patchValue([]),(0,F.r)(e,o,this.form)}clearSubCategory(){this.form.get("subCategories")?.patchValue(null)}removeImage(e,o){o&&St().isURL(o)?(this.deletedImages.push(o),this.productData.data.images=this.productData.data.images.filter((a,r)=>r!=e)):(this.imageSrcs.splice(e,1),this.form.get("images").removeAt(e))}setFormData(){this.form.get("name")?.patchValue(this.productData.data.name),this.form.get("fullDesc")?.patchValue(this.productData.data.fullDesc),this.form.get("shortDesc")?.patchValue(this.productData.data.shortDesc),this.form.get("category")?.patchValue(this.productData.data.category?._id),this.form.get("brand")?.patchValue(this.productData.data.brand?._id),this.form.get("subCategory")?.patchValue(this.productData.data.subCategory?._id),this.form.get("status")?.patchValue(this.productData.data.status),this.form.get("isCustomize")?.patchValue(this.productData.data.isCustomize),this.form.get("quantity")?.patchValue(this.productData.data.quantity),this.form.get("sellingPrice")?.patchValue(this.productData.data.sellingPrice),this.form.get("mrp")?.patchValue(this.productData.data.mrp),this.form.get("sizes")?.patchValue(this.productData.data.sizes),this.form.get("color")?.patchValue(this.productData.data.color)}onFormSubmit(e){var o=this;return(0,S.Z)(function*(){if(o.form.get("isCustomize")?.patchValue(o.isCustomize),o.form.invalid)return void o.form.markAllAsTouched();let a=o.form.getRawValue();o.isFormSubmitted=!0,console.log({rawData:a,f:o.productData.data.images});try{let r=yield o.productService.putProduct(o.productData.data?._id,a,o.productData.data.images);o.uiService.openSnackbar(r.message),o.isFormSubmitted=!1,o.location.back()}catch{o.isFormSubmitted=!1}})()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}openImageGuideline(){this.uiService.openModal("#ImageGuideline",{modalTitle:"Image GuideLine",points:this.sharedService.imageGuidline}).afterClose.subscribe(e=>{})}setSubCategories(e){!e||(this.form?.get("subCategory")?.patchValue(null),this.subCategories=[],e&&this.categories?.forEach(o=>{o?._id==e&&(this.subCategories=o.subCategories||[])}))}clearMainCategory(){this.form.get("subCategory")?.patchValue(null),this.subCategories=[]}updateProductStatus(){this.isCustomize=!this.isCustomize,console.log(this.isCustomize)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g.gz),t.Y36(d.qu),t.Y36(f.M),t.Y36(U.G),t.Y36(M.c),t.Y36(v.F),t.Y36(u.Ye),t.Y36(k.F))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-update-product"]],decls:18,vars:2,consts:[[1,"page-wrapper"],[1,"content","container-fluid"],[1,"page-header"],[1,"row"],[1,"col-sm-7","col-auto"],[1,"page-title"],[1,"col-sm-5","col"],[1,"btn-group","btn-group-sm","float-right"],[1,"btn","btn-sm","btn-primary","mt-2",3,"click"],[1,"fa","fa-arrow-left"],["class","col-sm-12",4,"ngIf"],["class","card-body",4,"ngIf"],[1,"col-sm-12"],[3,"formGroup","ngSubmit"],[1,"card"],[1,"card-body"],[1,"col-6"],[1,"form-group"],["for","validationServer01",1,"required-label"],["maxlength","200","type","text","id","validationServer01","placeholder","Name","required","","formControlName","name",1,"form-control",3,"ngClass"],[3,"control","fieldName","maxLength"],[1,"col-6","col-md-6"],["type","checkbox","id","status_1",1,"check",3,"ngClass"],["for","status_1",1,"checktoggle",3,"click"],[1,"col-md-12"],["id","editor1","formControlName","shortDesc",3,"ngClass","config"],[3,"control","fieldName"],["id","editor2","formControlName","fullDesc",3,"ngClass","config"],[1,"card-header"],[1,"col-md-4"],["formControlName","category",3,"ngClass","appendTo","loading","loadingText","searchable","notFoundText","placeholder","change","clear"],["col",""],[3,"value",4,"ngFor","ngForOf"],["for","validationServer01"],["formControlName","subCategory",3,"ngClass","appendTo","loadingText","searchable","notFoundText","placeholder"],["col2",""],["formControlName","brand",3,"ngClass","appendTo","loadingText","searchable","notFoundText","placeholder","clear"],["col3",""],["formControlName","sizes",3,"ngClass","multiple","appendTo","loadingText","searchable","notFoundText","placeholder","clear"],["for","quantity"],["type","number","formControlName","quantity",1,"form-control"],["for","sellingPrice"],["type","number","formControlName","sellingPrice",1,"form-control"],["for","mrp"],["type","number","formControlName","mrp",1,"form-control"],["for","color"],["type","text","formControlName","color",1,"form-control"],["download","assets/img/ADD-PRODUCT.png","href","assets/img/ADD-PRODUCT.png"],["href","javascript:void(0)",1,"btn","btn-sm","btn-link","cursor",3,"click"],["multiple","","type","file","accept","image/*","id","validationServer02",1,"form-control",3,"hidden","focus","change"],["images",""],["type","button",1,"btn","btn-primary","btn-sm","float-right","mt-2",3,"click"],[1,"fa","fa-upload"],[1,"row","m-1"],["class","col-12",4,"ngIf"],[4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary","float-right",3,"disabled"],["class","spinner-border spinner-border-sm mr-2","role","status",4,"ngIf"],[3,"value"],[1,"col-12"],[1,"d-flex","align-content-start","pt-2"],[1,"mr-2"],[1,"d-flex"],["data-fancybox","gallery",3,"href"],[1,"img-thumbnail",2,"height","100px",3,"src"],[1,"mb-1","cursor","trashImage",3,"click"],[1,"fa","fa-trash-o","text-danger"],["role","status",1,"spinner-border","spinner-border-sm","mr-2"],["mode","indeterminate"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h3",5),t._uU(6,"Update Product"),t.qZA()(),t.TgZ(7,"div",6)(8,"div",7)(9,"button",8),t.NdJ("click",function(){return o.location.back()}),t._UZ(10,"i",9),t._uU(11," Back"),t.qZA()()()()(),t.TgZ(12,"div",3),t.YNc(13,Lt,112,58,"div",10),t.YNc(14,zt,2,0,"div",11),t.qZA(),t._UZ(15,"br")(16,"br"),t.qZA()(),t._UZ(17,"app-info-modal")),2&e&&(t.xp6(13),t.Q6J("ngIf",o.form&&o.dataIsLoaded),t.xp6(1),t.Q6J("ngIf",!o.dataIsLoaded))},dependencies:[u.mk,u.sg,u.O5,d._Y,d.Fj,d.wV,d.JJ,d.JL,d.Q7,d.nD,d.sg,d.u,P.pW,Q.w,y.s6,b.w9,b.jq,qt,L.I],styles:[".example-chip-list[_ngcontent-%COMP%]{width:100%}.mat-form-field-wrapper[_ngcontent-%COMP%]{padding-bottom:0!important}  .mat-primary .mat-option.mat-selected:not(.mat-option-disabled){color:unset}  .mat-option-pseudo-checkbox.mat-pseudo-checkbox-checked{background-color:#007bff}.variantWidth[_ngcontent-%COMP%]{width:200px}.variantInput[_ngcontent-%COMP%]{min-width:200px;max-width:100%}.trashImage[_ngcontent-%COMP%]{position:relative;right:25px;background:black;height:min-content;padding:0 6px}"]}),i})()}];let Ot=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.Bz.forChild(Yt),g.Bz]}),i})(),wt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[u.ez]}),i})();var Vt=l(7523),Gt=l(9657),Rt=l(1601),Kt=l(1961),Ht=l(6738),Bt=l(2712),jt=l(3677),$t=l(8173),Et=l(1689);let Xt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[f.M,U.G,{provide:I.TP,useClass:Kt.s,multi:!0},{provide:A._A,useClass:D.t7,deps:[A.Ad,D.o8]},{provide:A.sG,useValue:{parse:{dateInput:"LL"},display:{dateInput:"LL",dateA11yLabel:"LL",monthYearLabel:"MMM YYYY",monthYearA11yLabel:"MMMM YYYY"}}}],imports:[u.ez,Ot,I.JF,d.UX,O.m,$t.u,jt.I,Bt.q,Et.n,Rt.X,Ht.a,y.UM,Gt.E,b.A0,x.Xt,wt,Vt.F]}),i})()}}]);